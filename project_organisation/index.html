<!DOCTYPE html>
<html lang="en">
	<head>
		
		
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
		<meta name="author" content="Juliette Hayer and Lokman Galal">
		<link rel="canonical" href="https://jhayer.github.io/bacterial_genomics_training/project_organisation/">
		<link rel="shortcut icon" href="../img/favicon.ico">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<title>Project organisation - Bioinformatics Tutorials for Bacterial Genomics</title>
		<link href="../bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="../css/font-awesome-5.12.2-all.min.css" rel="stylesheet">
		<link href="../css/base.css" rel="stylesheet">
		<link rel="stylesheet" href="../css/highlight-github.css">
		<script src="../bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="../js/highlight.pack.js"></script>
		
		<script>
			var base_url = '..';
			var home_url = '../usage';
			var is_outer_page = false;
			
			var pageToc = [
				{title: "Project organization and management", url: "#_top", children: [
						
				{title: "Structure or architecture of a data science project", url: "#_top", children: [
				]},
				{title: "More about data structure and metadata", url: "#more-about-data-structure-and-metadata", children: [
				]},
				]},
				{title: "Exercise", url: "#exercise", children: [
						
				{title: "Set up", url: "#_top", children: [
				]},
				{title: "Downloading the data", url: "#downloading-the-data", children: [
				]},
				{title: "Our first analysis script", url: "#our-first-analysis-script", children: [
				]},
				{title: "Saving the result", url: "#saving-the-result", children: [
				]},
				{title: "Improving our script", url: "#improving-our-script", children: [
				]},
				{title: "Investigating further", url: "#investigating-further", children: [
				]},
				]},
			];

		</script>
		<script src="../js/base.js"></script> 
	</head>

	<body class="inner-page">
		

		<div class="container-fluid wm-page-content">
			<a name="_top" aria-hidden="true"></a>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../unix/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../unix/" class="btn btn-sm btn-link">
			The Unix system
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../itrop/" class="btn btn-sm btn-link">
			iTrop computing cluster
		</a>
		<a href="../itrop/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			

			<h2 id="project-organization-and-management">Project organization and management<a class="headerlink" href="#project-organization-and-management" title="Permanent link">#</a></h2>
<p>Most of the the project organization material can be found at <a href="https://software-carpentry.org">https://software-carpentry.org</a> and <a href="http://www.datacarpentry.org">http://www.datacarpentry.org</a></p>
<p>Many thanks to them for existing!</p>
<h3 id="structure-or-architecture-of-a-data-science-project">Structure or architecture of a data science project<a class="headerlink" href="#structure-or-architecture-of-a-data-science-project" title="Permanent link">#</a></h3>
<p>Some good practice when you will organise your project directory on the server, on the cloud or any other machine where you will compute:</p>
<blockquote>
<p>Create 3 or 4 different directories within you project directory (use <code>mkdir</code>):</p>
<p><code>data/</code> for keeping the raw data</p>
<p><code>results/</code> for all the outputs from the multiple analyses that you will perform</p>
<p><code>docs/</code> for all the notes written about the analyses carried out (ex: <code>history &gt; 20221114.logs</code> for the commands executed today)</p>
<p><code>scripts/</code> for all the scripts that you will use to produce the results
</p>
</blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should always have the raw data in (at least) one place and not modify them</p>
</div>
<h3 id="more-about-data-structure-and-metadata">More about data structure and metadata<a class="headerlink" href="#more-about-data-structure-and-metadata" title="Permanent link">#</a></h3>
<ul>
<li>
<p>direct link to the tutorial used fo the lesson: <a href="http://www.datacarpentry.org/shell-genomics/06-organization/">Shell genomics: project organisation</a></p>
</li>
<li>
<p>good practice for the structure of data and metadata of a genomics project: <a href="http://www.datacarpentry.org/organization-genomics/">Organisation of genomics project</a></p>
</li>
<li>
<p>Some extra material: <a href="http://www.datacarpentry.org/spreadsheet-ecology-lesson/">Spreadsheet ecology lesson</a></p>
</li>
</ul>
<h2 id="exercise">Exercise<a class="headerlink" href="#exercise" title="Permanent link">#</a></h2>
<p>This exercise combines the knowledge you have acquired during the <a href="unix">unix</a> and <a href="project_org">project organisation</a> lessons.</p>
<p>You have designed an experiment where you are studying the species and weight of animals caught in plots in a study area.
Data was collected by a third party a deposited in <a href="https://figshare.com/articles/Portal_Project_Teaching_Database/1314459">figshare</a>, a public database.</p>
<p>Our goals are to download and exploring the data, while keeping an organised project directory</p>
<h3 id="set-up">Set up<a class="headerlink" href="#set-up" title="Permanent link">#</a></h3>
<p>First we go to our working directory for this training and create a project directory</p>
<pre><code class="language-bash">cd ~/bioinfo_training
mkdir animals
cd animals
</code></pre>
<p>As we saw during the project organization tutorial, it is good practice to separate data, results and scripts.
Let us create those three directories</p>
<pre><code class="language-bash">mkdir data results scripts
</code></pre>
<h3 id="downloading-the-data">Downloading the data<a class="headerlink" href="#downloading-the-data" title="Permanent link">#</a></h3>
<p>First we go to our <code>data</code> directory</p>
<pre><code class="language-bash">cd data
</code></pre>
<p>then we download our data file and give it a more appropriate name</p>
<pre><code class="language-bash">wget https://ndownloader.figshare.com/files/2292169
mv 2292169 data_joined.csv
</code></pre>
<p>Since we'll never modify our raw data file (or at least we <em>do not want to!</em>) it is safer to remove the writing permissions</p>
<pre><code class="language-bash">chmod -w data_joined.csv
ls -l
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>what if my data is really big?
Usually when you download data that is several gigabytes large, they will usually be compressed.
You learnt about compression during the <a href="software">installing software</a> lesson.</p>
</div>
<p>Let us look at the first few lines of our file:</p>
<pre><code class="language-bash">cd ..
head data/data_joined.csv
</code></pre>
<p>Our data file is a <code>.csv</code> file, that is a file where fields are separated by commas <code>,</code>.
Each row represent an animal that was caught in a plot, and each column contains information about that animal.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How many animals do we have?</p>
</div>
<pre><code class="language-bash">wc -l data/data_joined.csv
# 34787 data/data_joined.csv
</code></pre>
<p>It seems that our dataset contains 34787 lines.
Since each line is an animals, we caught a grand total of 34787 animals over the course of our study.</p>
<h3 id="our-first-analysis-script">Our first analysis script<a class="headerlink" href="#our-first-analysis-script" title="Permanent link">#</a></h3>
<p>we saw when we did the <code>head</code> command that all 10 first plots captured rodents.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Is rodent the only taxon that we have captured?</p>
</div>
<p>In our csv file, we can see that "taxa" is the 12th column.
We can print only that column using the <code>cut</code> command</p>
<pre><code class="language-bash">cut -d ',' -f 12 data/data_joined.csv | head
</code></pre>
<p>We still pipe in in head because we do not want to print 34787 line to our screen.
Additionally <code>head</code> makes us notice that we still have the column header printed out</p>
<pre><code class="language-bash">cut -d ',' -f 12 data/data_joined.csv | tail -n +2 | uniq -c
</code></pre>
<p>But while <code>uniq</code> is supposed to count all occurrence of a word, it only count similar <em>adjacent</em> occurrences.
Before counting, we need to sort our input:</p>
<pre><code class="language-bash">cut -d ',' -f 12 data/data_joined.csv | tail -n +2 | sort | uniq -c
</code></pre>
<p>We see that although we caught a vast majority of rodents, we also caught reptiles, birds and rabbits!</p>
<p>Now that we have a working one-liner, let us put it into a script</p>
<pre><code class="language-bash">nano scripts/taxa_count.sh
</code></pre>
<p>and write</p>
<pre><code class="language-bash"># script that prints the count of species for csv files
cut -d ',' -f 12 &quot;$1&quot; | tail -n +2 | sort | uniq -c
</code></pre>
<h3 id="saving-the-result">Saving the result<a class="headerlink" href="#saving-the-result" title="Permanent link">#</a></h3>
<pre><code class="language-bash">bash scripts/taxa_count.sh data/data_joined.csv &gt; results/taxa_count.txt
</code></pre>
<pre><code class="language-bash">cat results/taxa_count.txt
</code></pre>
<h3 id="improving-our-script">Improving our script<a class="headerlink" href="#improving-our-script" title="Permanent link">#</a></h3>
<p>We would also like to know the distribution of the numbers of animals caught in plots each year.
The year is the 4th column in our dataset and our script, in its current state, always selects the 12th columns of a file.</p>
<p>We can change our script to make it flexible so that the user can chose which columns they wishes to work on.</p>
<pre><code class="language-bash">nano scripts/taxa_count.sh
</code></pre>
<pre><code class="language-bash"># script that prints the count of occurrence in one column for csv files
cut -d ',' -f &quot;$2&quot; &quot;$1&quot; | tail -n +2 | sort | uniq -c
</code></pre>
<p>Now it doesn't make much sense to have it named <code>taxa_count.sh</code></p>
<pre><code class="language-bash">mv scripts/taxa_count.sh scripts/column_count.sh
</code></pre>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>which year did we catch the most animals?
try to answer programmatically.</p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>save the sorted output to a file in the <code>results</code> directory.</p>
</div>
<h3 id="investigating-further">Investigating further<a class="headerlink" href="#investigating-further" title="Permanent link">#</a></h3>
<p>We'd like to refine our animal count and knowing how many animals of each taxon were captured every year</p>
<p>we can use <code>cut</code> on several columns like this:</p>
<pre><code class="language-bash">cut -d ',' -f 4,12 &quot;data/data_joined.csv&quot; | tail -n +2 | sort | uniq -c
</code></pre>
<p>Now that we are happy with our one-liner, let us save it in a script:</p>
<pre><code class="language-bash">nano scripts/taxa_per_year.sh
</code></pre>
<p>then save the output to <code>results/taxa_per_year.txt</code></p>
<pre><code>bash scripts/taxa_per_year.sh &gt; results/taxa_per_year.txt
</code></pre>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Which year was the first reptile captured?</p>
</div>
<p>The next step would be to refine our analysis by year. We will save one individual output for each year count</p>
<h4 id="the-seq-command">The seq command<a class="headerlink" href="#the-seq-command" title="Permanent link">#</a></h4>
<p>To perform what we want to do, we need to be able to loop over the years.
The <code>seq</code> command can help us with that.</p>
<p>First we try</p>
<pre><code class="language-bash">seq 1 10
</code></pre>
<p>then</p>
<pre><code class="language-bash">seq 1997 2002
</code></pre>
<p>and what about the span of years we are interested in?</p>
<pre><code class="language-bash">seq 1977 2002
</code></pre>
<p>Great! So now does it work with a for loop?</p>
<pre><code class="language-bash">for year in $(seq 1977 2002)
    do
        echo $year
    done
</code></pre>
<p>It does!</p>
<p>Before doing our analysis on each year, we still have to figure out how to do it on one year.</p>
<pre><code class="language-bash">grep 1998 results/taxa_per_year.txt
</code></pre>
<p>"Grepping" the year seems to work.
Now we need to save it into a file containing the year</p>
<p>First let's create a directory where to store our results</p>
<pre><code class="language-bash">mkdir results/years
</code></pre>
<p>and we try to redirect our yearly count into a file</p>
<pre><code class="language-bash">grep 1998 results/taxa_per_year.txt &gt; results/years/1998-count.txt
</code></pre>
<pre><code>bash
cat results/years/1998-count.txt
</code></pre>
<p>It seems to have worked.
Now with the loop</p>
<pre><code class="language-bash">for year in $(seq 1977 2002)
    do
        grep $year results/taxa_per_year.txt &gt; results/years/$year-count.txt
    done
</code></pre>
<pre><code class="language-bash">ls results/years
</code></pre>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Put your loop in a script</p>
</div>

			<br>
			






<div class="row pt-2 pb-4">
	<div class="col-sm text-center text-sm-left">
		<a href="../unix/" class="btn btn-sm btn-outline-dark">
			<i class="fa fa-chevron-left" aria-hidden="true"></i>
			Previous
		</a>
		<a href="../unix/" class="btn btn-sm btn-link">
			The Unix system
		</a>
	</div>
	

	
	<div class="col-sm text-center text-sm-right">
		<a href="../itrop/" class="btn btn-sm btn-link">
			iTrop computing cluster
		</a>
		<a href="../itrop/" class="btn btn-sm btn-outline-dark">
			Next
			<i class="fa fa-chevron-right" aria-hidden="true"></i>
		</a>
	</div>
	
</div>

			<br>
		</div>

		<footer class="container-fluid wm-page-content text-center small">
			<p>
			<a href="https://github.com/jhayer/bacterial_genomics_training/edit/master/docs/project_organisation.md" target="_blank">Edit on jhayer/bacterial_genomics_training</a>
			</p>
			<details>
				<summary>
					Documentation built with <a href="http://www.mkdocs.org/" target="_blank">MkDocs</a> using  <a href="https://github.com/Siphalor/mkdocs-custommill" target="_blank">CustomMill</a>.
				</summary>
				<h6 class="mt-2">Additional Licenses</h6>
				<ul><li>
						CustomMill is based on the <a href="https://github.com/gristlabs/mkdocs-windmill" target="_blank">Windmill</a> theme by Grist Labs, licensed under the <a href="https://github.com/gristlabs/mkdocs-windmill/blob/master/LICENSE" target="_blank">MIT License</a>
					</li>
					<li>
						CustomMill includes <a href="https://getbootstrap.com" target="_blank">Bootstrap</a> version 5.1.3. This is available under the <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT License</a>.
					</li>
					<li>
						Syntax highlighting is implemented via <a href="https://highlightjs.org" target="_blank">highlight.js</a> licensed under the BSD 3-Clause License and the included github styling made by Vasily Polovnyov.
					</li>
					<li>
						Icons on this site are from <a href="https://fontawesome.com/" target="_blank">Font Awesome</a> which is licensed under the <a href="https://fontawesome.com/license/free" target="_blank">Font Awesome Free License</a>.
					</li></ul>
				<p>Built at 2022-11-16 11:40:55 UTC</p>
			</details>
		</footer>

		
	</body>
</html>